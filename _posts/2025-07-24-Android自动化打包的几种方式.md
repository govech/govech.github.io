---
title: Androidè‡ªåŠ¨åŒ–æ‰“åŒ…çš„å‡ ç§æ–¹å¼
date: 2025-07-24
---



åœ¨ Android é¡¹ç›®ä¸­ï¼Œå®ç° **è‡ªåŠ¨åŒ–æ‰“åŒ…æµç¨‹ï¼ˆAuto Build/CI Buildï¼‰** å¯ä»¥æå¤§æå‡å¼€å‘æ•ˆç‡ï¼Œé¿å…æ‰‹åŠ¨æ“ä½œå‡ºé”™ã€‚ä»¥ä¸‹æ˜¯å®ç°æ–¹å¼ã€å¸¸è§æ–¹æ¡ˆåŠå®æˆ˜å»ºè®®ï¼š

------

## âœ… ä¸€ã€è‡ªåŠ¨åŒ–æ‰“åŒ…æµç¨‹æ ¸å¿ƒæ­¥éª¤

1. **å‡†å¤‡å·¥ä½œï¼š**

   - é…ç½® `build.gradle` æ”¯æŒå¤šæ¸ é“ã€å¤šç‰ˆæœ¬æ„å»º
   - å®šä¹‰æ‰“åŒ…å‚æ•°ï¼ˆå¦‚ç‰ˆæœ¬å·ã€æ¸ é“å·ã€ç¯å¢ƒå˜é‡ç­‰ï¼‰
   - åˆ›å»ºè‡ªå®šä¹‰ Gradle Task

2. **æ‰“åŒ…æµç¨‹ï¼š**

   ```
   ä»£ç æ‹‰å– â†’ ä¾èµ–è¿˜åŸ â†’ æ„å»ºå˜ä½“é€‰æ‹© â†’ ç­¾åé…ç½® â†’ æ‰“åŒ… APK/AAB â†’ ä¸Šä¼ æˆ–å‘å¸ƒ
   ```

3. **è§¦å‘æ–¹å¼ï¼š**

   - æ‰‹åŠ¨æ‰§è¡Œï¼ˆæœ¬åœ°æˆ–è„šæœ¬ï¼‰
   - CI å¹³å°è‡ªåŠ¨è§¦å‘ï¼ˆå¦‚ push/tag/pull requestï¼‰

------

## ğŸš€ äºŒã€ä¸»æµè‡ªåŠ¨åŒ–æ‰“åŒ…æ–¹æ¡ˆ

### 1. æœ¬åœ°è„šæœ¬æ‰“åŒ…ï¼ˆé€‚åˆå°å›¢é˜Ÿï¼‰

- ç¼–å†™ Shell / Gradle è„šæœ¬å®ç°ï¼š

```bash
./gradlew assembleRelease \
  -PversionName=1.0.0 \
  -PbuildChannel=official \
  --stacktrace
```

- å¯å°è£…ä¸ºæ‰“åŒ…å…¥å£è„šæœ¬ `build.sh` æˆ– `.bat`

------

### 2. ä½¿ç”¨ CI å¹³å°ï¼ˆæ¨èï¼‰

#### âœ… GitHub Actions

- å…è´¹ã€è½»é‡ã€é€‚åˆå¼€æºé¡¹ç›®å’Œä¸ªäººå¼€å‘è€…
- ç¤ºä¾‹ï¼š

```yaml
name: Android CI

on:
  push:
    branches: [ "main" ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: æ‹‰å–ä»£ç 
      uses: actions/checkout@v3

    - name: è®¾ç½® JDK
      uses: actions/setup-java@v3
      with:
        java-version: '17'

    - name: ç¼“å­˜ Gradle
      uses: actions/cache@v3
      with:
        path: ~/.gradle/caches
        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*') }}

    - name: æ„å»º APK
      run: ./gradlew assembleRelease

    - name: ä¸Šä¼ äº§ç‰©
      uses: actions/upload-artifact@v3
      with:
        name: app-release.apk
        path: app/build/outputs/apk/release/app-release.apk
```

------

#### âœ… GitLab CI

- ä¼ä¸šå¸¸ç”¨ï¼Œæ”¯æŒ Runner çµæ´»éƒ¨ç½²

```yaml
stages:
  - build

build_release:
  stage: build
  script:
    - ./gradlew assembleRelease
  artifacts:
    paths:
      - app/build/outputs/apk/release/
```

------

#### âœ… Jenkins

- è‡ªç”±åº¦é«˜ï¼Œé€‚åˆä¼ä¸šå¤æ‚æµç¨‹
- æ’ä»¶ä¸°å¯Œï¼ˆå¦‚ Gitã€Gradleã€Android Emulatorã€Fastlaneï¼‰
- å¯é…ç½®æ‰“åŒ…+æµ‹è¯•+éƒ¨ç½²ä¸€ä½“åŒ–æµæ°´çº¿

------

#### âœ… CircleCI / Bitrise / Codemagicï¼ˆç§»åŠ¨å¼€å‘å‹å¥½ï¼‰

- ä¸“ä¸º Android/iOS æä¾›ä¼˜åŒ–
- UI æµç¨‹é…ç½®ç®€å•
- å¯ç›´æ¥å‘å¸ƒåˆ° Play Store / TestFlight

------

## ğŸ§° ä¸‰ã€è¾…åŠ©å·¥å…·æ¨è

| å·¥å…·                   | è¯´æ˜                                                         |
| ---------------------- | ------------------------------------------------------------ |
| **Fastlane**           | è‡ªåŠ¨ç­¾åã€æ‰“åŒ…ã€ä¸Šä¼  APK åˆ° Firebase / Google Playï¼Œéå¸¸å¼ºå¤§ |
| **Gradle**             | æ ¸å¿ƒæ„å»ºç³»ç»Ÿï¼Œæ”¯æŒè‡ªå®šä¹‰ Task å’Œå¤šæ¸ é“                       |
| **Keystore åŠ å¯†**      | CI ç¯å¢ƒä¸­é€šè¿‡ç¯å¢ƒå˜é‡æˆ–åŠ å¯†å·¥å…·ä¿æŠ¤ç­¾åæ–‡ä»¶å’Œå¯†ç             |
| **version.properties** | ç”¨äºç»Ÿä¸€ç®¡ç†ç‰ˆæœ¬å·å’Œæ¸ é“å‚æ•°                                 |



------

## ğŸ› ï¸ å››ã€å®æˆ˜å»ºè®®

| åœºæ™¯                        | å»ºè®®                                                     |
| --------------------------- | -------------------------------------------------------- |
| å¤šæ¸ é“æ‰“åŒ…                  | ä½¿ç”¨ Gradle flavorï¼ˆproductFlavorsï¼‰é…ç½®                 |
| å¤šç¯å¢ƒåˆ‡æ¢ï¼ˆdev/test/prodï¼‰ | ä½¿ç”¨ `buildConfigField` æˆ– `resValue` æ§åˆ¶å˜é‡           |
| è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·              | ä½¿ç”¨ Git Tag æˆ–è„šæœ¬è‡ªåŠ¨ä¿®æ”¹ `versionCode`ã€`versionName` |
| ç°åº¦å‘å¸ƒæˆ–ABæµ‹è¯•            | é…åˆæ¸ é“æ‰“åŒ…ã€å¼€å…³æ§åˆ¶ã€åå°ç­–ç•¥                         |



------

## ğŸ“¦ äº”ã€äº§ç‰©è¾“å‡ºå»ºè®®

| ç±»å‹         | è¾“å‡ºè·¯å¾„                             |
| ------------ | ------------------------------------ |
| APK          | `app/build/outputs/apk/`             |
| AAB          | `app/build/outputs/bundle/`          |
| Mapping æ–‡ä»¶ | `app/build/outputs/mapping/release/` |
| æ—¥å¿—è¾“å‡º     | `./logs/build.log` å¯ç”¨è„šæœ¬é‡å®šå‘    |



------

## ğŸ§ª å…­ã€CIç¯å¢ƒä¸‹å¸¸è§é—®é¢˜ä¸è§£å†³

| é—®é¢˜               | è§£å†³æ–¹æ¡ˆ                          |
| ------------------ | --------------------------------- |
| ç­¾åæ–‡ä»¶æ‰¾ä¸åˆ°     | ç”¨ç¯å¢ƒå˜é‡åŠ å¯†æ–¹å¼ä¼ å…¥ï¼Œå†è§£å¯†    |
| Gradle ç¼“å­˜æ…¢      | ä½¿ç”¨ç¼“å­˜æ’ä»¶ï¼ˆå¦‚ GitHub Cacheï¼‰   |
| æ„å»ºæ—¶é—´è¿‡é•¿       | ç¦ç”¨ä¸å¿…è¦çš„ä»»åŠ¡ï¼Œå¦‚ lintã€test   |
| æƒé™æˆ–å¯†é’¥æ³„æ¼é£é™© | ä¸è¦å°† keystoreã€å¯†ç ç›´æ¥ä¸Šä¼ ä»“åº“ |